
Running 12 tests using 6 workers

ðŸ”§ Setting up test environment...
ðŸ”§ Setting up test environment...
ðŸ”§ Setting up test environment...
ðŸ“Š Page Load Time: 2.59 seconds
âœ… KPI - NFR 1.1 PASS: Page load time <= 3 seconds
  âœ“   3 [chromium] â€º tests\e2e\kpi.spec.ts:38:5 â€º KPI - NFR 1.1: Page Load Speed (Maksimal 3 detik) (3.5s)
ðŸ”§ Setting up test environment...
âš ï¸ Login failed: Login failed with status 401
âš ï¸ Login failed: Login failed with status 401
âš ï¸ Trying to register new user...
âš ï¸ Trying to register new user...
âš ï¸ Login failed: Login failed with status 401
âš ï¸ Trying to register new user...
  âœ“   1 [chromium] â€º tests\e2e\auth.spec.ts:11:9 â€º Authentication Flow â€º should fail login with invalid credentials (13.3s)
ðŸ”§ Setting up test environment...
  âœ˜   2 [chromium] â€º tests\e2e\auth.spec.ts:4:9 â€º Authentication Flow â€º should show login page (14.8s)
âš ï¸ Login failed: Login failed with status 401
âš ï¸ Trying to register new user...
âœ… User registration successful (or already exists)
âœ… User registration successful (or already exists)
âœ… User registration successful (or already exists)
âœ… User registration successful (or already exists)
âœ… Registered and logged in as Facility management user (ID: 65)
âŒ Gagal login setelah register. Error: Login failed with status 500
âŒ Gagal login setelah register. Error: Login failed with status 500
  -   5 [chromium] â€º tests\e2e\kpi.spec.ts:271:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 1.2: Waktu Proses Simpan dan Update data (Maks 2 detik)
âœ… Registered and logged in as Facility management user (ID: 65)
âš ï¸ Login failed: Login failed with status 500
âš ï¸ Trying to register new user...
âœ… User registration successful (or already exists)
âœ… Test panel created: 22
âœ… Test environment setup complete
âœ… Test panel created: 21
âœ… Test environment setup complete
âœ… Registered and logged in as Facility management user (ID: 65)
âœ… Test panel created: 23
âœ… Test environment setup complete
ðŸ“Š Password Hash (SHA256): b55c8792d1ce458e...
âœ… KPI - NFR 2.1 PASS: Password menggunakan SHA256 hashing
  âœ“   9 [chromium] â€º tests\e2e\kpi.spec.ts:344:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.1: Password pengguna menggunakan Metode Hashing SHA256 (3.1s)
Failed to delete panel 23: 405
  âœ˜   8 [chromium] â€º tests\e2e\kpi.spec.ts:955:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - FR 3.2.2: Akurasi Validasi Input (Input jumlah KWh dan tagihan tidak boleh minus, nol, decimal, atau huruf) (4.0s)
ðŸ”Ž Input data: { bulan: [32m'2026-01'[39m, kwh: [32m'77021'[39m, tagihan: [32m'151871'[39m }
ðŸ“Š Buttons with visual indicators: 2/5
ðŸ“Š Status elements with icons/text: 0/0
âš ï¸ Tidak ada status element dengan icon/text. Cek UI!
âœ… KPI - NFR 4.1 CHECKED: UI dicek untuk deuteranopia
  âœ“   6 [chromium] â€º tests\e2e\kpi.spec.ts:537:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 4.1: Dukungan Deuteranopia (UI dapat dibedakan oleh pengguna mengalami buta warna) (15.4s)
ðŸ”Ž No select element found, trying dropdown
ðŸ”Ž Found panel dropdown, clicking...
ðŸ”Ž Found 2 panel options in dropdown
ðŸ”Ž Option 0: Memuat panel...
ðŸ”Ž Option 1: Tambah Nama Panel Gedung
ðŸ”Ž Found dropdown option, clicking on second option (skip placeholder)...
ðŸ”Ž Panel dropdown text after selection: "Memuat panel..."
âœ… Panel berhasil dipilih
ðŸ”Ž Form values before submit: { bulan: [32m'2026-01'[39m, kwh: [32m'77021'[39m, tagihan: [32m'151871'[39m }
ðŸ”Ž Menekan tombol submit...
âŒ Submit form gagal! Notifikasi error: 
âŒ Submit form gagal! Notifikasi error: 
âŒ Submit form gagal! Notifikasi error: 
Failed to delete panel 21: 405
  âœ˜   4 [chromium] â€º tests\e2e\kpi.spec.ts:406:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.2: Proteksi Input (100% terlindung dari serangan SQL Injection) (30.1s)
  âœ˜   7 [chromium] â€º tests\e2e\kpi.spec.ts:717:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 3.1: Zero Data Loss (Tidak ada data hilang jika sistem gagal saat proses input/edit) (21.6s)
ðŸ”§ Setting up test environment...
ðŸ”§ Setting up test environment...
âœ… Using existing Facility management user (ID: 65)
âš ï¸ Login failed: Login failed with status 500
âš ï¸ Trying to register new user...
âœ… Test panel created: 24
âœ… Test environment setup complete
âœ… User registration successful (or already exists)
âœ… Registered and logged in as Facility management user (ID: 65)
âœ… Test panel created: 25
âœ… Test environment setup complete
Failed to delete panel 22: 405
  âœ˜  10 [chromium] â€º tests\e2e\kpi.spec.ts:594:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 4.2: Indikator Visual (Notifikasi success/error harus menggunakan ikon khusus) (32.4s)
Failed to delete panel 25: 405
  âœ˜  12 [chromium] â€º tests\e2e\kpi.spec.ts:472:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.4: Manajemen Sesi (Logout otomatis setelah 5 menit tanpa aktivitas) (24.0s)
Failed to delete panel 24: 405
  âœ˜  11 [chromium] â€º tests\e2e\kpi.spec.ts:895:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - FR 3.2.1: Akurasi Validasi Penyimpanan (Sistem menolak simpan jika ada field kosong dengan notifikasi spesifik) (30.1s)


  1) [chromium] â€º tests\e2e\auth.spec.ts:4:9 â€º Authentication Flow â€º should show login page â”€â”€â”€â”€â”€â”€â”€â”€

    Error: [2mexpect([22m[31mpage[39m[2m).[22mtoHaveTitle[2m([22m[32mexpected[39m[2m)[22m failed

    Expected pattern: [32m/Login/i[39m
    Received string:  [31m"Campus Facility Management System"[39m
    Timeout: 5000ms

    Call log:
    [2m  - Expect "toHaveTitle" with timeout 5000ms[22m
    [2m    8 Ã— unexpected value "Campus Facility Management System"[22m


       5 |         await page.goto('/login');
       6 |         // Check for role input or heading
    >  7 |         await expect(page).toHaveTitle(/Login/i);
         |                            ^
       8 |         await expect(page.locator('input[name="role"]')).toBeVisible();
       9 |     });
      10 |
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\auth.spec.ts:7:28

    Error Context: test-results\auth-Authentication-Flow-should-show-login-page-chromium\error-context.md

  2) [chromium] â€º tests\e2e\kpi.spec.ts:406:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.2: Proteksi Input (100% terlindung dari serangan SQL Injection) 

    [31mTest timeout of 30000ms exceeded.[39m

    Error: apiRequestContext.fetch: Request context disposed.
    Call log:
    [2m  - â†’ POST http://localhost:3000/api/auth/login[22m
    [2m    - user-agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.7499.4 Safari/537.36[22m
    [2m    - accept: */*[22m
    [2m    - accept-encoding: gzip,deflate,br[22m
    [2m    - Content-Type: application/json[22m
    [2m    - content-length: 48[22m


       at ..\helpers\api-request-helper.ts:20

      18 |     }
      19 |
    > 20 |     const response = await request.fetch(endpoint, {
         |                                    ^
      21 |         method: options.method,
      22 |         data: options.body,
      23 |         headers: headers,
        at apiRequest (C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\helpers\api-request-helper.ts:20:36)
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\kpi.spec.ts:426:51

  3) [chromium] â€º tests\e2e\kpi.spec.ts:472:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.4: Manajemen Sesi (Logout otomatis setelah 5 menit tanpa aktivitas) 

    Error: page.evaluate: Execution context was destroyed, most likely because of a navigation

      521 |         // Verify bahwa user sudah di-logout (token dihapus atau redirect ke login)
      522 |         const currentUrl = page.url();
    > 523 |         const tokenAfter = await page.evaluate(() => localStorage.getItem('accessToken'));
          |                                       ^
      524 |
      525 |         // Sistem harus logout otomatis (token dihapus atau redirect ke login)
      526 |         const isLoggedOut = !tokenAfter || currentUrl.includes('/login');
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\kpi.spec.ts:523:39

    Error Context: test-results\kpi-ðŸ“Š-KPI-Validation-Test-9a17a-ah-5-menit-tanpa-aktivitas--chromium\error-context.md

  4) [chromium] â€º tests\e2e\kpi.spec.ts:594:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 4.2: Indikator Visual (Notifikasi success/error harus menggunakan ikon khusus) 

    [31mTest timeout of 30000ms exceeded.[39m

    Error: page.waitForSelector: Test timeout of 30000ms exceeded.
    Call log:
    [2m  - waiting for locator('input[name="bulan"]') to be visible[22m


      604 |         }, accessToken);
      605 |         await page.goto('/electricity-bills/input', { waitUntil: 'load' });
    > 606 |         await page.waitForSelector('input[name="bulan"]', { timeout: 10000 });
          |                    ^
      607 |         const currentMonth = new Date().toISOString().slice(0, 7);
      608 |         await page.fill('input[name="bulan"]', currentMonth);
      609 |         const selectPanel = page.locator('select').first();
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\kpi.spec.ts:606:20

    Error Context: test-results\kpi-ðŸ“Š-KPI-Validation-Test-b94e4-us-menggunakan-ikon-khusus--chromium\error-context.md

  5) [chromium] â€º tests\e2e\kpi.spec.ts:717:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 3.1: Zero Data Loss (Tidak ada data hilang jika sistem gagal saat proses input/edit) 

    Error: Form submit gagal: 
    Saran debug: cek validasi input di UI dan backend, pastikan semua field terisi dan format benar.

      839 |                     notifText = await notifLocator.first().textContent() || '';
      840 |                     console.error('âŒ Submit form gagal! Notifikasi error:', notifText);
    > 841 |                     throw new Error('Form submit gagal: ' + notifText + '\nSaran debug: cek validasi input di UI dan backend, pastikan semua field terisi dan format benar.');
          |                           ^
      842 |                 }
      843 |             } catch (err) {
      844 |                 if (i === 2) throw err;
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\kpi.spec.ts:841:27

    Error Context: test-results\kpi-ðŸ“Š-KPI-Validation-Test-99a37-gal-saat-proses-input-edit--chromium\error-context.md

  6) [chromium] â€º tests\e2e\kpi.spec.ts:895:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - FR 3.2.1: Akurasi Validasi Penyimpanan (Sistem menolak simpan jika ada field kosong dengan notifikasi spesifik) 

    [31mTest timeout of 30000ms exceeded.[39m

    Error: page.reload: Test timeout of 30000ms exceeded.
    Call log:
    [2m  - waiting for navigation until "load"[22m
    [2m    - navigated to "http://localhost:3000/electricity-bills/input"[22m


      937 |
      938 |         // Test 3: Submit dengan KWh kosong
    > 939 |         await page.reload({ waitUntil: 'load' });
          |                    ^
      940 |         await page.waitForSelector('input[name="bulan"]', { timeout: 10000 });
      941 |
      942 |         await page.fill('input[name="bulan"]', new Date().toISOString().slice(0, 7));
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\kpi.spec.ts:939:20

    Error Context: test-results\kpi-ðŸ“Š-KPI-Validation-Test-49b3f-dengan-notifikasi-spesifik--chromium\error-context.md

  7) [chromium] â€º tests\e2e\kpi.spec.ts:955:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - FR 3.2.2: Akurasi Validasi Input (Input jumlah KWh dan tagihan tidak boleh minus, nol, decimal, atau huruf) 

    Error: [2mexpect([22m[31mreceived[39m[2m).[22mtoContain[2m([22m[32mexpected[39m[2m) // indexOf[22m

    Expected value: [32m500[39m
    Received array: [31m[400, 422][39m

      977 |         });
      978 |
    > 979 |         expect([400, 422]).toContain(negativeResponse.status());
          |                            ^
      980 |         const negativeData = await getJsonResponse(negativeResponse);
      981 |         expect(negativeData).toHaveProperty('error');
      982 |
        at C:\Kuliah\Semester 7\PM\tubes\multidisiplin2025\tests\e2e\kpi.spec.ts:979:28

  7 failed
    [chromium] â€º tests\e2e\auth.spec.ts:4:9 â€º Authentication Flow â€º should show login page â”€â”€â”€â”€â”€â”€â”€â”€â”€
    [chromium] â€º tests\e2e\kpi.spec.ts:406:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.2: Proteksi Input (100% terlindung dari serangan SQL Injection) 
    [chromium] â€º tests\e2e\kpi.spec.ts:472:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 2.4: Manajemen Sesi (Logout otomatis setelah 5 menit tanpa aktivitas) 
    [chromium] â€º tests\e2e\kpi.spec.ts:594:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 4.2: Indikator Visual (Notifikasi success/error harus menggunakan ikon khusus) 
    [chromium] â€º tests\e2e\kpi.spec.ts:717:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - NFR 3.1: Zero Data Loss (Tidak ada data hilang jika sistem gagal saat proses input/edit) 
    [chromium] â€º tests\e2e\kpi.spec.ts:895:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - FR 3.2.1: Akurasi Validasi Penyimpanan (Sistem menolak simpan jika ada field kosong dengan notifikasi spesifik) 
    [chromium] â€º tests\e2e\kpi.spec.ts:955:9 â€º ðŸ“Š KPI Validation Tests (9 Test Cases - Auth Required) â€º KPI - FR 3.2.2: Akurasi Validasi Input (Input jumlah KWh dan tagihan tidak boleh minus, nol, decimal, atau huruf) 
  1 skipped
  4 passed (1.7m)
